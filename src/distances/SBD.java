/* Copyright (C) 2019 Chang Wei Tan, Francois Petitjean, Geoff Webb
 This file is part of Varying length TSC.
 Varying length TSC is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, version 3 of the License.
 Varying length TSC is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 You should have received a copy of the GNU General Public License
 along with Varying length TSC.  If not, see <http://www.gnu.org/licenses/>. */
package distances;

import data.Sequence;
import signalProcessing.DSP;

/**
 * This is a class to compute Shape Based distance
 *
 * @author Chang Wei
 */
public class SBD {
    private int shift;

    public static void main(String[] args) {
        double[] a = {0.2801, 0.2948, 0.3088, 0.3220, 0.3345, 0.3463, 0.3574, 0.3678, 0.3776, 0.3867, 0.3952, 0.4031, 0.4103, 0.4171, 0.4232, 0.4288, 0.4339, 0.4385, 0.4425, 0.4461, 0.4493, 0.4520, 0.4542, 0.4561, 0.4576, 0.4587, 0.4594, 0.4596, 0.4595, 0.4589, 0.4580, 0.4568, 0.4553, 0.4535, 0.4515, 0.4492, 0.4468, 0.4443, 0.4416, 0.4390, 0.4363, 0.4337, 0.4313, 0.4289, 0.4268, 0.4250, 0.4235, 0.4223, 0.4216, 0.4214, 0.4216, 0.4224, 0.4238, 0.4258, 0.4285, 0.4319, 0.4359, 0.4406, 0.4459, 0.4520, 0.4587, 0.4660, 0.4739, 0.4824, 0.4914, 0.5009, 0.5108, 0.5211, 0.5316, 0.5425, 0.5535, 0.5646, 0.5758, 0.5870, 0.5980, 0.6090, 0.6197, 0.6302, 0.6404, 0.6502, 0.6596, 0.6685, 0.6770, 0.6849, 0.6923, 0.6991, 0.7054, 0.7112, 0.7164, 0.7211, 0.7254, 0.7291, 0.7325, 0.7354, 0.7381, 0.7404, 0.7425, 0.7444, 0.7462, 0.7479, 0.7496, 0.7513, 0.7531, 0.7551, 0.7573, 0.7598, 0.7625, 0.7656, 0.7690, 0.7728, 0.7771, 0.7818, 0.7870, 0.7927, 0.7989, 0.8056, 0.8128, 0.8205, 0.8287, 0.8374, 0.8466, 0.8561, 0.8661, 0.8765, 0.8872, 0.8982, 0.9095, 0.9211, 0.9328, 0.9446, 0.9566, 0.9686, 0.9806, 0.9925, 1.0043, 1.0160, 1.0275, 1.0387, 1.0497, 1.0603, 1.0705, 1.0804, 1.0897, 1.0986, 1.1070, 1.1147, 1.1219, 1.1285, 1.1345, 1.1398, 1.1445, 1.1485, 1.1519, 1.1546, 1.1566, 1.1580, 1.1587, 1.1589, 1.1584, 1.1573, 1.1557, 1.1536, 1.1510, 1.1480, 1.1445, 1.1407, 1.1365, 1.1320, 1.1272, 1.1222, 1.1170, 1.1117, 1.1062, 1.1007, 1.0951, 1.0895, 1.0839, 1.0783, 1.0728, 1.0673, 1.0620, 1.0568, 1.0518, 1.0469, 1.0421, 1.0375, 1.0332, 1.0290, 1.0250, 1.0212, 1.0176, 1.0142, 1.0110, 1.0081, 1.0053, 1.0028, 1.0005, 0.9985, 0.9967, 0.9952, 0.9939, 0.9929, 0.9922, 0.9918, 0.9918, 0.9921, 0.9927, 0.9938, 0.9953, 0.9971, 0.9995, 1.0023, 1.0056, 1.0094, 1.0138, 1.0187, 1.0241, 1.0302, 1.0368, 1.0440, 1.0518, 1.0602, 1.0692, 1.0788, 1.0889, 1.0996, 1.1108, 1.1226, 1.1348, 1.1474, 1.1605, 1.1738, 1.1875, 1.2015, 1.2156, 1.2298, 1.2442, 1.2585, 1.2728, 1.2869, 1.3008, 1.3145, 1.3279, 1.3408, 1.3534, 1.3654, 1.3768, 1.3877, 1.3979, 1.4074, 1.4162, 1.4242, 1.4315, 1.4380, 1.4436, 1.4485, 1.4526, 1.4559, 1.4584, 1.4602, 1.4613, 1.4617, 1.4614, 1.4606, 1.4592, 1.4574, 1.4551, 1.4525, 1.4496, 1.4464, 1.4430, 1.4396, 1.4360, 1.4325, 1.4291, 1.4257, 1.4225, 1.4195, 1.4168, 1.4143, 1.4122, 1.4104, 1.4089, 1.4078, 1.4070, 1.4067, 1.4066, 1.4070, 1.4077, 1.4088, 1.4101, 1.4117, 1.4136, 1.4157, 1.4181, 1.4206, 1.4232, 1.4259, 1.4287, 1.4315, 1.4343, 1.4371, 1.4398, 1.4424, 1.4449, 1.4472, 1.4493, 1.4512, 1.4529, 1.4544, 1.4556, 1.4565, 1.4572, 1.4575, 1.4576, 1.4573, 1.4568, 1.4559, 1.4547, 1.4532, 1.4513, 1.4491, 1.4465, 1.4436, 1.4404, 1.4368, 1.4328, 1.4285, 1.4239, 1.4188, 1.4135, 1.4077, 1.4016, 1.3951, 1.3883, 1.3810, 1.3735, 1.3655, 1.3572, 1.3486, 1.3396, 1.3303, 1.3207, 1.3108, 1.3007, 1.2903, 1.2797, 1.2689, 1.2579, 1.2468, 1.2356, 1.2244, 1.2131, 1.2018, 1.1906, 1.1795, 1.1684, 1.1576, 1.1469, 1.1364, 1.1262, 1.1163, 1.1066, 1.0973, 1.0883, 1.0797, 1.0714, 1.0635, 1.0559, 1.0487, 1.0419, 1.0354, 1.0293, 1.0235, 1.0181, 1.0130, 1.0082, 1.0037, 0.9996, 0.9957, 0.9921, 0.9887, 0.9856, 0.9827, 0.9800, 0.9775, 0.9752, 0.9732, 0.9713, 0.9696, 0.9681, 0.9667, 0.9656, 0.9646, 0.9638, 0.9632, 0.9628, 0.9625, 0.9624, 0.9625, 0.9628, 0.9632, 0.9638, 0.9645, 0.9654, 0.9663, 0.9674, 0.9685, 0.9696, 0.9708, 0.9719, 0.9729, 0.9739, 0.9747, 0.9752, 0.9756, 0.9757, 0.9754, 0.9747, 0.9737, 0.9721, 0.9701, 0.9675, 0.9644, 0.9607, 0.9564, 0.9514, 0.9458, 0.9396, 0.9327, 0.9252, 0.9170, 0.9081, 0.8987, 0.8885, 0.8778, 0.8665, 0.8546, 0.8422, 0.8293, 0.8158, 0.8019, 0.7875, 0.7726, 0.7574, 0.7417, 0.7256, 0.7091, 0.6923, 0.6751, 0.6575, 0.6396, 0.6213, 0.6027, 0.5837, 0.5644, 0.5446, 0.5246, 0.5042, 0.4834, 0.4622, 0.4407, 0.4189, 0.3967, 0.3741, 0.3513, 0.3281, 0.3046, 0.2809, 0.2569, 0.2327, 0.2083, 0.1838, 0.1592, 0.1346, 0.1100, 0.0854, 0.0609, 0.0366, 0.0125, -0.0114, -0.0350, -0.0582, -0.0810, -0.1035, -0.1255, -0.1470, -0.1680, -0.1885, -0.2085, -0.2280, -0.2471, -0.2656, -0.2837, -0.3014, -0.3186, -0.3355, -0.3521, -0.3684, -0.3844, -0.4003, -0.4159, -0.4315, -0.4470, -0.4625, -0.4780, -0.4935, -0.5091, -0.5249, -0.5407, -0.5567, -0.5729, -0.5893, -0.6058, -0.6226, -0.6395, -0.6565, -0.6738, -0.6911, -0.7086, -0.7261, -0.7437, -0.7612, -0.7788, -0.7962, -0.8135, -0.8307, -0.8476, -0.8642, -0.8805, -0.8965, -0.9120, -0.9271, -0.9417, -0.9558, -0.9694, -0.9823, -0.9947, -1.0065, -1.0176, -1.0281, -1.0380, -1.0473, -1.0560, -1.0641, -1.0716, -1.0786, -1.0851, -1.0911, -1.0966, -1.1017, -1.1064, -1.1108, -1.1149, -1.1187, -1.1224, -1.1259, -1.1293, -1.1327, -1.1360, -1.1394, -1.1428, -1.1464, -1.1501, -1.1540, -1.1582, -1.1626, -1.1672, -1.1722, -1.1775, -1.1831, -1.1890, -1.1953, -1.2019, -1.2088, -1.2161, -1.2236, -1.2314, -1.2394, -1.2477, -1.2561, -1.2646, -1.2732, -1.2819, -1.2905, -1.2991, -1.3075, -1.3158, -1.3240, -1.3318, -1.3393, -1.3465, -1.3533, -1.3597, -1.3656, -1.3710, -1.3759, -1.3803, -1.3841, -1.3874, -1.3901, -1.3922, -1.3938, -1.3949, -1.3954, -1.3955, -1.3951, -1.3943, -1.3932, -1.3916, -1.3898, -1.3877, -1.3855, -1.3831, -1.3805, -1.3780, -1.3754, -1.3729, -1.3705, -1.3683, -1.3663, -1.3645, -1.3631, -1.3619, -1.3612, -1.3609, -1.3610, -1.3616, -1.3626, -1.3642, -1.3662, -1.3688, -1.3719, -1.3754, -1.3794, -1.3839, -1.3889, -1.3942, -1.4000, -1.4061, -1.4126, -1.4194, -1.4264, -1.4336, -1.4411, -1.4487, -1.4564, -1.4641, -1.4719, -1.4797, -1.4875, -1.4952, -1.5028, -1.5102, -1.5174, -1.5244, -1.5312, -1.5377, -1.5438, -1.5497, -1.5551, -1.5602, -1.5648, -1.5690, -1.5727, -1.5759, -1.5786, -1.5808, -1.5824, -1.5835, -1.5841, -1.5840, -1.5834, -1.5822, -1.5804, -1.5781, -1.5751, -1.5716, -1.5676, -1.5630, -1.5578, -1.5521, -1.5459, -1.5392, -1.5321, -1.5245, -1.5165, -1.5081, -1.4994, -1.4904, -1.4811, -1.4716, -1.4619, -1.4520, -1.4421, -1.4322, -1.4222, -1.4123, -1.4025, -1.3929, -1.3834, -1.3742, -1.3652, -1.3566, -1.3483, -1.3404, -1.3329, -1.3258, -1.3192, -1.3131, -1.3074, -1.3023, -1.2976, -1.2935, -1.2898, -1.2866, -1.2839, -1.2816, -1.2798, -1.2783, -1.2773, -1.2766, -1.2762, -1.2761, -1.2763, -1.2767, -1.2773, -1.2781, -1.2790, -1.2799, -1.2810, -1.2820, -1.2830, -1.2839, -1.2848, -1.2856, -1.2862, -1.2866, -1.2869, -1.2869, -1.2868, -1.2863, -1.2856, -1.2846, -1.2833, -1.2817, -1.2798, -1.2775, -1.2750, -1.2721, -1.2689, -1.2653, -1.2614, -1.2572, -1.2527, -1.2479, -1.2427, -1.2373, -1.2316, -1.2257, -1.2195, -1.2130, -1.2064, -1.1996, -1.1926, -1.1855, -1.1782, -1.1708, -1.1633, -1.1558, -1.1482, -1.1407, -1.1331, -1.1255, -1.1180, -1.1106, -1.1032, -1.0959, -1.0888, -1.0817, -1.0748, -1.0680, -1.0614, -1.0549, -1.0486, -1.0424, -1.0364, -1.0305, -1.0247, -1.0190, -1.0134, -1.0079, -1.0025, -0.9971, -0.9918, -0.9865, -0.9812, -0.9759, -0.9706, -0.9652, -0.9598, -0.9543, -0.9487, -0.9431, -0.9374, -0.9315, -0.9256, -0.9195, -0.9134, -0.9071, -0.9007, -0.8943, -0.8877, -0.8810, -0.8743, -0.8675, -0.8607, -0.8537, -0.8468, -0.8398, -0.8328, -0.8258, -0.8188, -0.8119, -0.8049, -0.7980, -0.7912, -0.7844, -0.7776, -0.7710, -0.7644, -0.7578, -0.7514, -0.7450, -0.7387, -0.7325, -0.7264, -0.7203, -0.7143, -0.7084, -0.7025, -0.6967, -0.6910, -0.6853, -0.6797, -0.6742, -0.6687, -0.6632, -0.6578, -0.6524, -0.6471, -0.6418, -0.6365, -0.6313, -0.6260, -0.6208, -0.6156, -0.6104, -0.6051, -0.5999, -0.5947, -0.5895, -0.5842, -0.5790, -0.5737, -0.5683, -0.5630, -0.5576, -0.5522, -0.5467, -0.5412, -0.5357, -0.5302, -0.5246, -0.5190, -0.5133, -0.5077, -0.5020, -0.4964, -0.4908, -0.4851, -0.4796, -0.4740, -0.4685, -0.4631, -0.4578, -0.4526, -0.4474, -0.4424, -0.4375, -0.4328, -0.4282, -0.4237, -0.4195, -0.4153, -0.4113, -0.4075, -0.4038, -0.4003, -0.3970, -0.3940, -0.3912, -0.3887, -0.3864, -0.3844, -0.3827, -0.3811, -0.3798, -0.3787, -0.3778, -0.3770, -0.3764, -0.3759, -0.3755, -0.3752, -0.3749, -0.3746, -0.3744, -0.3740, -0.3737, -0.3732, -0.3727, -0.3720, -0.3712, -0.3703, -0.3691, -0.3678, -0.3663, -0.3646, -0.3627, -0.3606, -0.3582, -0.3556, -0.3527, -0.3496, -0.3463, -0.3427, -0.3389, -0.3348, -0.3304, -0.3258, -0.3210, -0.3159, -0.3106, -0.3050, -0.2992, -0.2933, -0.2872, -0.2810, -0.2750, -0.2689, -0.2629, -0.2570, -0.2511, -0.2452, -0.2394, -0.2336, -0.2279, -0.2221, -0.2164, -0.2107, -0.2049, -0.1992, -0.1934, -0.1876, -0.1817, -0.1759, -0.1699, -0.1639, -0.1578, -0.1517, -0.1455, -0.1393, -0.1329, -0.1265, -0.1200, -0.1135, -0.1068, -0.1001, -0.0934, -0.0865, -0.0796, -0.0726, -0.0656, -0.0584, -0.0512, -0.0440, -0.0366, -0.0292, -0.0218, -0.0142, -0.0066, 0.0011, 0.0088, 0.0165, 0.0243, 0.0321, 0.0398, 0.0474, 0.0551, 0.0628, 0.0706, 0.0785, 0.0865, 0.0946, 0.1028, 0.1111, 0.1195, 0.1281, 0.1368, 0.1456, 0.1546, 0.1637, 0.1730, 0.1825, 0.1921, 0.2020, 0.2120, 0.2222, 0.2326, 0.2433, 0.2541, 0.2652, 0.2765,};
        double[] b = {0.4747, 0.4801, 0.4853, 0.4905, 0.4955, 0.5004, 0.5051, 0.5098, 0.5143, 0.5188, 0.5232, 0.5275, 0.5317, 0.5359, 0.5400, 0.5441, 0.5481, 0.5522, 0.5562, 0.5602, 0.5642, 0.5682, 0.5722, 0.5763, 0.5804, 0.5845, 0.5887, 0.5930, 0.5974, 0.6020, 0.6066, 0.6114, 0.6163, 0.6214, 0.6266, 0.6319, 0.6374, 0.6430, 0.6487, 0.6546, 0.6605, 0.6666, 0.6728, 0.6790, 0.6854, 0.6917, 0.6982, 0.7047, 0.7112, 0.7177, 0.7242, 0.7306, 0.7371, 0.7434, 0.7498, 0.7560, 0.7622, 0.7684, 0.7744, 0.7803, 0.7862, 0.7920, 0.7977, 0.8033, 0.8088, 0.8142, 0.8196, 0.8249, 0.8302, 0.8355, 0.8407, 0.8459, 0.8512, 0.8565, 0.8619, 0.8674, 0.8730, 0.8786, 0.8845, 0.8904, 0.8965, 0.9028, 0.9093, 0.9160, 0.9229, 0.9299, 0.9371, 0.9446, 0.9522, 0.9600, 0.9679, 0.9760, 0.9843, 0.9926, 1.0010, 1.0096, 1.0181, 1.0267, 1.0353, 1.0439, 1.0524, 1.0608, 1.0692, 1.0773, 1.0853, 1.0931, 1.1007, 1.1079, 1.1149, 1.1216, 1.1279, 1.1338, 1.1394, 1.1445, 1.1492, 1.1534, 1.1572, 1.1606, 1.1634, 1.1658, 1.1678, 1.1693, 1.1704, 1.1711, 1.1715, 1.1715, 1.1712, 1.1706, 1.1699, 1.1690, 1.1679, 1.1668, 1.1657, 1.1647, 1.1637, 1.1629, 1.1624, 1.1621, 1.1621, 1.1625, 1.1633, 1.1645, 1.1663, 1.1686, 1.1715, 1.1749, 1.1790, 1.1837, 1.1890, 1.1949, 1.2015, 1.2087, 1.2165, 1.2248, 1.2337, 1.2431, 1.2530, 1.2633, 1.2739, 1.2849, 1.2961, 1.3076, 1.3192, 1.3308, 1.3426, 1.3543, 1.3659, 1.3773, 1.3886, 1.3997, 1.4105, 1.4210, 1.4311, 1.4409, 1.4503, 1.4593, 1.4679, 1.4761, 1.4839, 1.4913, 1.4982, 1.5048, 1.5110, 1.5169, 1.5224, 1.5276, 1.5324, 1.5371, 1.5414, 1.5456, 1.5495, 1.5533, 1.5569, 1.5604, 1.5638, 1.5671, 1.5703, 1.5735, 1.5767, 1.5798, 1.5829, 1.5860, 1.5891, 1.5923, 1.5954, 1.5986, 1.6018, 1.6050, 1.6083, 1.6116, 1.6149, 1.6183, 1.6217, 1.6252, 1.6287, 1.6324, 1.6361, 1.6399, 1.6439, 1.6480, 1.6522, 1.6567, 1.6613, 1.6660, 1.6710, 1.6762, 1.6816, 1.6871, 1.6929, 1.6988, 1.7050, 1.7112, 1.7176, 1.7241, 1.7306, 1.7371, 1.7436, 1.7501, 1.7563, 1.7624, 1.7682, 1.7737, 1.7788, 1.7834, 1.7875, 1.7910, 1.7938, 1.7958, 1.7971, 1.7975, 1.7969, 1.7954, 1.7928, 1.7892, 1.7844, 1.7786, 1.7715, 1.7634, 1.7541, 1.7436, 1.7320, 1.7193, 1.7056, 1.6908, 1.6751, 1.6586, 1.6412, 1.6231, 1.6044, 1.5844, 1.5635, 1.5419, 1.5201, 1.4981, 1.4764, 1.4549, 1.4340, 1.4136, 1.3940, 1.3751, 1.3571, 1.3398, 1.3234, 1.3077, 1.2928, 1.2785, 1.2648, 1.2515, 1.2386, 1.2260, 1.2134, 1.2008, 1.1880, 1.1748, 1.1612, 1.1470, 1.1319, 1.1160, 1.0989, 1.0807, 1.0611, 1.0400, 1.0174, 0.9932, 0.9671, 0.9393, 0.9096, 0.8779, 0.8442, 0.8086, 0.7710, 0.7314, 0.6899, 0.6465, 0.6013, 0.5544, 0.5058, 0.4558, 0.4043, 0.3517, 0.2980, 0.2434, 0.1899, 0.1375, 0.0866, 0.0373, -0.0103, -0.0561, -0.1000, -0.1419, -0.1817, -0.2194, -0.2550, -0.2884, -0.3197, -0.3488, -0.3757, -0.4006, -0.4235, -0.4444, -0.4634, -0.4806, -0.4962, -0.5101, -0.5225, -0.5336, -0.5435, -0.5523, -0.5602, -0.5673, -0.5737, -0.5797, -0.5853, -0.5907, -0.5962, -0.6017, -0.6075, -0.6137, -0.6204, -0.6277, -0.6358, -0.6447, -0.6545, -0.6653, -0.6770, -0.6896, -0.7033, -0.7179, -0.7333, -0.7495, -0.7662, -0.7834, -0.8009, -0.8183, -0.8353, -0.8527, -0.8704, -0.8885, -0.9068, -0.9254, -0.9442, -0.9632, -0.9824, -1.0017, -1.0212, -1.0407, -1.0602, -1.0797, -1.0992, -1.1186, -1.1379, -1.1571, -1.1761, -1.1950, -1.2136, -1.2320, -1.2501, -1.2680, -1.2855, -1.3028, -1.3197, -1.3363, -1.3525, -1.3684, -1.3840, -1.3992, -1.4140, -1.4284, -1.4425, -1.4562, -1.4694, -1.4823, -1.4948, -1.5069, -1.5186, -1.5298, -1.5406, -1.5510, -1.5609, -1.5704, -1.5793, -1.5878, -1.5958, -1.6032, -1.6101, -1.6165, -1.6224, -1.6276, -1.6324, -1.6366, -1.6402, -1.6432, -1.6458, -1.6477, -1.6492, -1.6501, -1.6505, -1.6505, -1.6500, -1.6491, -1.6478, -1.6462, -1.6442, -1.6420, -1.6396, -1.6369, -1.6342, -1.6313, -1.6284, -1.6254, -1.6225, -1.6197, -1.6170, -1.6144, -1.6120, -1.6098, -1.6078, -1.6061, -1.6046, -1.6034, -1.6025, -1.6017, -1.6013, -1.6010, -1.6009, -1.6010, -1.6012, -1.6015, -1.6019, -1.6023, -1.6026, -1.6028, -1.6029, -1.6028, -1.6025, -1.6019, -1.6009, -1.5997, -1.5980, -1.5959, -1.5934, -1.5903, -1.5868, -1.5828, -1.5783, -1.5734, -1.5679, -1.5620, -1.5556, -1.5488, -1.5416, -1.5341, -1.5263, -1.5183, -1.5101, -1.5017, -1.4932, -1.4846, -1.4761, -1.4677, -1.4593, -1.4512, -1.4432, -1.4355, -1.4281, -1.4209, -1.4141, -1.4077, -1.4016, -1.3958, -1.3904, -1.3853, -1.3806, -1.3761, -1.3719, -1.3679, -1.3641, -1.3604, -1.3569, -1.3534, -1.3500, -1.3465, -1.3429, -1.3392, -1.3354, -1.3314, -1.3271, -1.3226, -1.3178, -1.3126, -1.3071, -1.3013, -1.2952, -1.2886, -1.2818, -1.2746, -1.2670, -1.2592, -1.2511, -1.2427, -1.2342, -1.2254, -1.2165, -1.2075, -1.1984, -1.1893, -1.1803, -1.1713, -1.1624, -1.1537, -1.1452, -1.1369, -1.1288, -1.1211, -1.1136, -1.1065, -1.0996, -1.0931, -1.0870, -1.0812, -1.0757, -1.0705, -1.0655, -1.0609, -1.0564, -1.0522, -1.0481, -1.0442, -1.0403, -1.0365, -1.0327, -1.0289, -1.0250, -1.0210, -1.0168, -1.0125, -1.0079, -1.0031, -0.9980, -0.9926, -0.9868, -0.9807, -0.9743, -0.9675, -0.9603, -0.9528, -0.9450, -0.9367, -0.9282, -0.9194, -0.9102, -0.9009, -0.8913, -0.8815, -0.8716, -0.8616, -0.8515, -0.8414, -0.8313, -0.8213, -0.8113, -0.8016, -0.7920, -0.7827, -0.7737, -0.7649, -0.7565, -0.7484, -0.7408, -0.7335, -0.7267, -0.7203, -0.7144, -0.7088, -0.7038, -0.6992, -0.6950, -0.6912, -0.6879, -0.6849, -0.6824, -0.6801, -0.6782, -0.6766, -0.6753, -0.6742, -0.6733, -0.6726, -0.6720, -0.6715, -0.6711, -0.6708, -0.6704, -0.6701, -0.6697, -0.6692, -0.6687, -0.6680, -0.6672, -0.6663, -0.6652, -0.6639, -0.6624, -0.6608, -0.6590, -0.6571, -0.6549, -0.6526, -0.6502, -0.6476, -0.6449, -0.6422, -0.6393, -0.6365, -0.6336, -0.6307, -0.6278, -0.6250, -0.6222, -0.6196, -0.6172, -0.6148, -0.6127, -0.6108, -0.6091, -0.6076, -0.6064, -0.6055, -0.6048, -0.6044, -0.6043, -0.6045, -0.6050, -0.6058, -0.6068, -0.6082, -0.6097, -0.6115, -0.6135, -0.6157, -0.6180, -0.6205, -0.6232, -0.6259, -0.6287, -0.6315, -0.6343, -0.6372, -0.6400, -0.6428, -0.6455, -0.6482, -0.6507, -0.6531, -0.6554, -0.6576, -0.6596, -0.6615, -0.6632, -0.6648, -0.6663, -0.6675, -0.6687, -0.6697, -0.6705, -0.6712, -0.6718, -0.6723, -0.6726, -0.6729, -0.6730, -0.6730, -0.6729, -0.6728, -0.6725, -0.6721, -0.6716, -0.6710, -0.6702, -0.6694, -0.6684, -0.6672, -0.6660, -0.6645, -0.6629, -0.6610, -0.6590, -0.6568, -0.6542, -0.6515, -0.6485, -0.6452, -0.6415, -0.6376, -0.6334, -0.6288, -0.6238, -0.6186, -0.6129, -0.6069, -0.6005, -0.5937, -0.5865, -0.5790, -0.5710, -0.5627, -0.5540, -0.5450, -0.5356, -0.5259, -0.5158, -0.5055, -0.4948, -0.4839, -0.4727, -0.4614, -0.4498, -0.4381, -0.4262, -0.4143, -0.4022, -0.3902, -0.3782, -0.3662, -0.3543, -0.3426, -0.3310, -0.3196, -0.3085, -0.2977, -0.2872, -0.2771, -0.2674, -0.2581, -0.2493, -0.2409, -0.2331, -0.2259, -0.2191, -0.2130, -0.2074, -0.2025, -0.1981, -0.1943, -0.1911, -0.1884, -0.1863, -0.1847, -0.1836, -0.1830, -0.1828, -0.1831, -0.1837, -0.1846, -0.1858, -0.1873, -0.1889, -0.1908, -0.1927, -0.1947, -0.1967, -0.1987, -0.2006, -0.2024, -0.2040, -0.2055, -0.2067, -0.2077, -0.2084, -0.2088, -0.2089, -0.2087, -0.2081, -0.2071, -0.2058, -0.2041, -0.2020, -0.1996, -0.1969, -0.1938, -0.1903, -0.1866, -0.1826, -0.1783, -0.1738, -0.1690, -0.1641, -0.1590, -0.1538, -0.1484, -0.1430, -0.1374, -0.1318, -0.1262, -0.1205, -0.1149, -0.1092, -0.1035, -0.0978, -0.0921, -0.0865, -0.0808, -0.0752, -0.0695, -0.0639, -0.0582, -0.0524, -0.0466, -0.0407, -0.0348, -0.0287, -0.0225, -0.0161, -0.0095, -0.0028, 0.0041, 0.0113, 0.0187, 0.0264, 0.0344, 0.0426, 0.0511, 0.0599, 0.0690, 0.0784, 0.0880, 0.0980, 0.1082, 0.1186, 0.1293, 0.1402, 0.1513, 0.1626, 0.1740, 0.1856, 0.1972, 0.2089, 0.2207, 0.2324, 0.2441, 0.2558, 0.2674, 0.2790, 0.2904, 0.3016, 0.3127, 0.3236, 0.3343, 0.3447, 0.3549, 0.3649, 0.3745, 0.3839, 0.3931, 0.4019, 0.4104, 0.4185, 0.4264, 0.4339, 0.4411, 0.4480, 0.4545, 0.4607, 0.4666, 0.4721, 0.4773, 0.4822, 0.4867, 0.4909, 0.4948, 0.4984, 0.5017, 0.5047, 0.5073, 0.5097, 0.5118, 0.5136, 0.5151, 0.5164, 0.5174, 0.5181, 0.5187, 0.5190, 0.5191, 0.5190, 0.5187, 0.5183, 0.5177, 0.5169, 0.5161, 0.5151, 0.5140, 0.5129, 0.5116, 0.5103, 0.5089, 0.5075, 0.5060, 0.5045, 0.5030, 0.5015, 0.4999, 0.4983, 0.4966, 0.4950, 0.4933, 0.4916, 0.4898, 0.4881, 0.4862, 0.4844, 0.4825, 0.4806, 0.4787, 0.4767, 0.4747, 0.4727, 0.4707, 0.4687, 0.4666, 0.4647, 0.4627, 0.4608, 0.4589, 0.4572, 0.4555, 0.4540, 0.4526, 0.4513, 0.4503, 0.4494, 0.4487, 0.4483, 0.4480, 0.4480, 0.4482, 0.4487, 0.4494, 0.4503, 0.4514, 0.4528, 0.4544, 0.4562, 0.4582, 0.4603, 0.4627, 0.4652, 0.4678, 0.4705, 0.4733, 0.4762, 0.4791, 0.4820, 0.4849, 0.4878, 0.4906, 0.4932, 0.4958, 0.4982, 0.5004, 0.5024, 0.5042, 0.5058, 0.5071, 0.5081, 0.5089, 0.5093, 0.5093, 0.5090, 0.5083, 0.5072, 0.5056, 0.5036, 0.5011, 0.4982, 0.4947, 0.4906, 0.4860, 0.4808, 0.4750, 0.4686, 0.4615, 0.4538, 0.4453,};

        SBD distComputer = new SBD();
        double distance = distComputer.distance(a, b);
        int shift = distComputer.getShift();

        System.out.println("Distance: " + distance);
        System.out.println("Shift: " + shift);
    }

    public int getShift() {
        return shift;
    }

    public double distance(final double[] a, final double[] b) {
        final double[] ncc = nccC(a, b);

        DSP.Pair max = DSP.maxWithIndex(ncc);
        final double dist = 1 - max.value;
        shift = max.index - a.length + 1;

        return dist;
    }

    public double distance(final Sequence first, final Sequence second) {
        if (second.length() > first.length())
            return distance(second, first);
        final double[] a = first.getData();
        final double[] b = second.getData();

        final double[] ncc = nccC(a, b);
        DSP.Pair max = DSP.maxWithIndex(ncc);
        final double dist = 1 - max.value;
        shift = max.index - a.length;

        return dist;
    }

    private double[] nccC(final double[] a, final double[] b) {
        final double[] cc = DSP.xcorr(a, b);
        final double raa = DSP.dot(a, a);
        final double rbb = DSP.dot(b, b);
        final double denom = Math.sqrt(raa * rbb);
        final double[] ncc = new double[cc.length];
        for (int i = 0; i < cc.length; i++)
            ncc[i] = cc[i] / denom;
        return ncc;
    }
}
